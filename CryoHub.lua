Obfuscated Lua
loadstring(game:HttpGet('data:text/plain;base64,bG9jYWwgdmFyX3A3dWpqNyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIHZhcl9weW9iYWwgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQpsb2NhbCB2YXJfcDRmYTQ2ID0gZ2FtZTpHZXRTZXJ2aWNlKCJWaXJ0dWFsSW5wdXRNYW5hZ2VyIikKbG9jYWwgdmFyXzNvem1rNSA9IHdvcmtzcGFjZS5DdXJyZW50Q2FtZXJhCmxvY2FsIHZhcl9uenYwNDMgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKbG9jYWwgdmFyXzNuOWo1ciA9IGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIikKbG9jYWwgdmFyX3Z1dXRydyA9IGdhbWU6R2V0U2VydmljZSgiUnVuU2VydmljZSIpCmxvY2FsIHZhcl9temRueHQgPSBnYW1lOkdldFNlcnZpY2UoIkxpZ2h0aW5nIikKCmxvY2FsIHZhcl9mODkzNW0gPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIHZhcl8za2FmcGsgPSBQbGF5ZXIuQ2hhcmFjdGVyIG9yIFBsYXllci5DaGFyYWN0ZXJBZGRlZDpXYWl0KCkKClBsYXllci5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKGNoYXIpCiAgICBDaGFyYWN0ZXIgPSBjaGFyCmVuZCkKCi0tIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbjogUmVkdWNlIHVwZGF0ZSBmcmVxdWVuY3kKbG9jYWwgdmFyX2hwMGRsMyA9IDAuMQoKbG9jYWwgdmFyXzg2eGd4ayA9IDQzCmxvY2FsIHZhcl84enA1MDAgPSBmYWxzZQpsb2NhbCB2YXJfYmdmaTJrID0gMC4zCmxvY2FsIHZhcl93Y2tpMTMgPSAiTG93IEFyYyIKbG9jYWwgdmFyXzh5a2N4ZiA9IGZhbHNlCmxvY2FsIHZhcl9zZTZmY2MgPSAiUEMiCmxvY2FsIHZhcl81b2ZoeXkgPSA2CgotLSBLb3JibG94ICYgSGVhZGxlc3MgVmFyaWFibGVzCmxvY2FsIHZhcl92M3UxYWogPSBmYWxzZQpsb2NhbCB2YXJfcWo1aHYzID0gZmFsc2UKbG9jYWwgdmFyX3pvNDRvbCA9IGZhbHNlCmxvY2FsIHZhcl9kMW9idDEgPSB7fQoKLS0gV2Fsa1NwZWVkIFZhcmlhYmxlcyAoQW50aS1LaWNrIEJ5cGFzcykKbG9jYWwgdmFyXzZ2Y29zeCA9IGZhbHNlCmxvY2FsIHZhcl9nanFnZmYgPSAxNgpsb2NhbCB2YXJfcWVvcDlwID0gMTYKCi0tIEZha2UgU2hvdCBWYXJpYWJsZXMKbG9jYWwgdmFyX2tyYXBueiA9IGZhbHNlCgotLSBXYWxrIEZsaW5nIFZhcmlhYmxlcwpsb2NhbCB2YXJfN2F2ZHVhID0gZmFsc2UKbG9jYWwgdmFyX3Z2djV6ZCA9IDEwMAoKLS0gUGVyZm9ybWFuY2UgVmFyaWFibGVzCmxvY2FsIHZhcl9lNGdnd3QgPSBmYWxzZQpsb2NhbCB2YXJfMmVreGFsID0gZmFsc2UKCi0tIEFudGkgVHJhdmVsIFZhcmlhYmxlcwpsb2NhbCB2YXJfenlyaXVrID0gZmFsc2UKbG9jYWwgdmFyX3J4YmYyYgpsb2NhbCB2YXJfaW81NWZqID0gZmFsc2UKCi0tIEF1dG8gRHVuayBWYXJpYWJsZXMKbG9jYWwgdmFyXzQ0dnA4eCA9IGZhbHNlCgotLSBBdXRvIEd1YXJkIFZhcmlhYmxlcwpsb2NhbCB2YXJfaWU1Mm1yCmxvY2FsIHZhcl94Z3J3bDQgPSB7ZW5hYmxlZCA9IGZhbHNlLCBydW5uaW5nID0gZmFsc2V9CmxvY2FsIHZhcl91aGNka3YsIGRyYWdnaW5nLCBkcmFnU3RhcnQsIHN0YXJ0UG9zCgotLSBCYWxsIE1hZ25ldCBWYXJpYWJsZXMgKE9wdGltaXplZCkKbG9jYWwgdmFyX2UzdmVwayA9IGZhbHNlCmxvY2FsIHZhcl8ydDQ3MjAgPSAxMDAKbG9jYWwgdmFyX3EyNHRreSA9IHsgRGlzdGFuY2UgPSBNYWdzQW1vdW50IH0KbG9jYWwgdmFyX2FiMmk4dCA9IHsgRGlzdGFuY2UgPSBNYWdzQW1vdW50IH0KCmxvY2FsIHZhcl8zbWFsZWIgR2V0Q2xvc2VzdFBhcnQoQmFsbCkKICAgIGlmIFBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgIGxvY2FsIHZhcl9va3dqbGsgPSBtYXRoLmh1Z2UKICAgICAgICBsb2NhbCB2YXJfcjk2bHA0CiAgICAgICAgZm9yIF8sIHYgaW4gcGFpcnMoUGxheWVyLkNoYXJhY3RlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiB2OklzQSgiQmFzZVBhcnQiKSB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfZTVlcGczID0gKHYuUG9zaXRpb24gLSBCYWxsLlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgIGlmIERpc3RhbmNlIDwgQ2xvc2VzdERpc3RhbmNlIHRoZW4KICAgICAgICAgICAgICAgICAgICBDbG9zZXN0RGlzdGFuY2UgPSBEaXN0YW5jZQogICAgICAgICAgICAgICAgICAgIENsb3Nlc3RQYXJ0ID0gdgogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHJldHVybiBDbG9zZXN0UGFydAogICAgZW5kCmVuZAoKZnVuY3Rpb24gQmFsbE1hZ3M6R2V0Q2xvc2VzdEJhbGwoKQogICAgbG9jYWwgdmFyX2VxMXYxaQogICAgbG9jYWwgdmFyXzQzdWpobCA9IG1hdGguaHVnZQogICAgZm9yIF8sIG9iaiBpbiBpcGFpcnMod29ya3NwYWNlOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgb2JqLk5hbWUgPT0gIkJhc2tldGJhbGwiIGFuZCBvYmo6RmluZEZpcnN0Q2hpbGQoIkJhbGwiKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIHZhcl90bnd5dmYgPSBvYmouQmFsbAogICAgICAgICAgICBsb2NhbCB2YXJfYTRyMG5sID0gUGxheWVyLkNoYXJhY3RlciBhbmQgUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAgICAgICAgIGlmIEJhbGwgYW5kIFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHZhcl93NTByOGogPSAoQmFsbC5Qb3NpdGlvbiAtIFJvb3RQYXJ0LlBvc2l0aW9uKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgIGlmIERpc3RhbmNlIDwgc2VsZi5EaXN0YW5jZSBhbmQgRGlzdGFuY2UgPCBDbG9zZXN0RGlzdGFuY2UgdGhlbgogICAgICAgICAgICAgICAgICAgIENsb3Nlc3RCYWxsID0gQmFsbAogICAgICAgICAgICAgICAgICAgIENsb3Nlc3REaXN0YW5jZSA9IERpc3RhbmNlCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBDbG9zZXN0QmFsbAplbmQKCmZ1bmN0aW9uIEJhbGxSZWFjaDpHZXRDbG9zZXN0QmFsbCgpCiAgICBsb2NhbCB2YXJfdzc5ZmM4CiAgICBsb2NhbCB2YXJfdnR1dzdzID0gbWF0aC5odWdlCiAgICBmb3IgXywgT3RoZXJQbGF5ZXIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgIGxvY2FsIHZhcl9odHBrZXUgPSBPdGhlclBsYXllci5DaGFyYWN0ZXIgYW5kIE90aGVyUGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiQmFza2V0YmFsbCIpIGFuZCBPdGhlclBsYXllci5DaGFyYWN0ZXIuQmFza2V0YmFsbDpGaW5kRmlyc3RDaGlsZCgiQmFsbCIpCiAgICAgICAgbG9jYWwgdmFyXzdhenpyMCA9IFBsYXllci5DaGFyYWN0ZXIgYW5kIFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKQogICAgICAgIGlmIEJhbGwgYW5kIFJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyX3psYXV5aSA9IChCYWxsLlBvc2l0aW9uIC0gUm9vdFBhcnQuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICBpZiBEaXN0YW5jZSA8IHNlbGYuRGlzdGFuY2UgYW5kIERpc3RhbmNlIDwgQ2xvc2VzdERpc3RhbmNlIHRoZW4KICAgICAgICAgICAgICAgIENsb3Nlc3RCYWxsID0gQmFsbAogICAgICAgICAgICAgICAgQ2xvc2VzdERpc3RhbmNlID0gRGlzdGFuY2UKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBDbG9zZXN0QmFsbAplbmQKCi0tIE9wdGltaXplZCBNYWdzOiBSZWR1Y2VkIGZyZXF1ZW5jeSB0byBwcmV2ZW50IGxhZwpsb2NhbCB2YXJfd3g5OG14IGFwcGx5TWFncygpCiAgICBpZiBNYWdzRW5hYmxlZCB0aGVuCiAgICAgICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdoaWxlIE1hZ3NFbmFibGVkIGRvCiAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgQmFsbFJlYWNoLkRpc3RhbmNlID0gTWFnc0Ftb3VudAogICAgICAgICAgICAgICAgICAgIEJhbGxNYWdzLkRpc3RhbmNlID0gTWFnc0Ftb3VudAoKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfdW1tb2htID0gQmFsbE1hZ3M6R2V0Q2xvc2VzdEJhbGwoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl83MHIxcXcgPSBCYWxsUmVhY2g6R2V0Q2xvc2VzdEJhbGwoKQogICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9ydHFxbDIsIFJvb3QyID0gTWFnc0JhbGwgYW5kIEdldENsb3Nlc3RQYXJ0KE1hZ3NCYWxsKSwgUmVhY2hCYWxsIGFuZCBHZXRDbG9zZXN0UGFydChSZWFjaEJhbGwpCgogICAgICAgICAgICAgICAgICAgIGlmIE1hZ3NCYWxsIGFuZCBSb290MSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KFJvb3QxLCBNYWdzQmFsbCwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMDAxKQogICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChSb290MSwgTWFnc0JhbGwsIDEpCiAgICAgICAgICAgICAgICAgICAgZW5kCgogICAgICAgICAgICAgICAgICAgIGlmIFJlYWNoQmFsbCBhbmQgUm9vdDIgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBmaXJldG91Y2hpbnRlcmVzdChSb290MiwgUmVhY2hCYWxsLCAwKQogICAgICAgICAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC4wMDEpCiAgICAgICAgICAgICAgICAgICAgICAgIGZpcmV0b3VjaGludGVyZXN0KFJvb3QyLCBSZWFjaEJhbGwsIDEpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoVVBEQVRFX0lOVEVSVkFMKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKZW5kCgpsb2NhbCB2YXJfODRzZDJnIEZpcmVEZXZpY2VFdmVudCgpCiAgICBpZiBSZXBsaWNhdGVkU3RvcmFnZTpGaW5kRmlyc3RDaGlsZCgiUmVtb3RlcyIpIGFuZCBSZXBsaWNhdGVkU3RvcmFnZS5SZW1vdGVzOkZpbmRGaXJzdENoaWxkKCJkZXZpY2VFdmVudCIpIHRoZW4KICAgICAgICBsb2NhbCB2YXJfbjNmMG8zID0ge1sxXSA9IERldmljZVR5cGV9CiAgICAgICAgUmVwbGljYXRlZFN0b3JhZ2UuUmVtb3Rlcy5kZXZpY2VFdmVudDpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgIGVuZAplbmQKCi0tIEtvcmJsb3ggRnVuY3Rpb25zCmxvY2FsIHZhcl9lcmNqY3MgYXBwbHlLb3JibG94KCkKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCB2YXJfczBkYm9mID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl82ZnlpZXcgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJSaWdodExvd2VyTGVnIikgb3IgY2hhcjpGaW5kRmlyc3RDaGlsZCgiUmlnaHQgTGVnIikKICAgICAgICBpZiByaWdodExlZyB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBvcmlnaW5hbExlZ3MuUmlnaHRMZWcgdGhlbgogICAgICAgICAgICAgICAgb3JpZ2luYWxMZWdzLlJpZ2h0TGVnID0gcmlnaHRMZWc6Q2xvbmUoKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIHJpZ2h0TGVnLlRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIHZhcl95eDZseWEgPSBJbnN0YW5jZS5uZXcoIlNwZWNpYWxNZXNoIikKICAgICAgICAgICAgbWVzaC5NZXNoSWQgPSAicmJ4YXNzZXRpZDovLzEzOTYwNzcxOCIKICAgICAgICAgICAgbWVzaC5UZXh0dXJlSWQgPSAicmJ4YXNzZXRpZDovLzEzOTYwNzcyOSIKICAgICAgICAgICAgbWVzaC5TY2FsZSA9IFZlY3RvcjMubmV3KDEsIDEsIDEpCiAgICAgICAgICAgIG1lc2guUGFyZW50ID0gcmlnaHRMZWcKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgpsb2NhbCB2YXJfOTEweXpiIHJlbW92ZUtvcmJsb3goKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHZhcl8xa3BsMHkgPSBQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyX244emF0dyA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0TG93ZXJMZWciKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkKCJSaWdodCBMZWciKQogICAgICAgIGlmIHJpZ2h0TGVnIHRoZW4KICAgICAgICAgICAgcmlnaHRMZWcuVHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgICBmb3IgXywgdiBpbiBwYWlycyhyaWdodExlZzpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgdjpJc0EoIlNwZWNpYWxNZXNoIikgdGhlbgogICAgICAgICAgICAgICAgICAgIHY6RGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKLS0gU2hvdyBObyBMZWcgRnVuY3Rpb25zCmxvY2FsIHZhcl9rNGphY3QgYXBwbHlTaG93Tm9MZWcoKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHZhcl9wdXE3c3UgPSBQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyXzRja3NycCA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0TG93ZXJMZWciKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkKCJSaWdodCBMZWciKQogICAgICAgIGxvY2FsIHZhcl91NDJkem0gPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJMZWZ0TG93ZXJMZWciKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkKCJMZWZ0IExlZyIpCiAgICAgICAgCiAgICAgICAgaWYgcmlnaHRMZWcgdGhlbiByaWdodExlZy5UcmFuc3BhcmVuY3kgPSAxIGVuZAogICAgICAgIGlmIGxlZnRMZWcgdGhlbiBsZWZ0TGVnLlRyYW5zcGFyZW5jeSA9IDEgZW5kCiAgICBlbmQpCmVuZAoKbG9jYWwgdmFyX21hcjZ0NiByZW1vdmVTaG93Tm9MZWcoKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHZhcl9jZDh4MzYgPSBQbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyX3lweDlscSA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIlJpZ2h0TG93ZXJMZWciKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkKCJSaWdodCBMZWciKQogICAgICAgIGxvY2FsIHZhcl8zcXAwNGcgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJMZWZ0TG93ZXJMZWciKSBvciBjaGFyOkZpbmRGaXJzdENoaWxkKCJMZWZ0IExlZyIpCiAgICAgICAgCiAgICAgICAgaWYgcmlnaHRMZWcgdGhlbiByaWdodExlZy5UcmFuc3BhcmVuY3kgPSAwIGVuZAogICAgICAgIGlmIGxlZnRMZWcgdGhlbiBsZWZ0TGVnLlRyYW5zcGFyZW5jeSA9IDAgZW5kCiAgICBlbmQpCmVuZAoKLS0gSGVhZGxlc3MgRnVuY3Rpb24KbG9jYWwgdmFyXzNydzJnNiBhcHBseUhlYWRsZXNzKCkKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCB2YXJfazkwdGNhID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl81Y2wwb2QgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIZWFkIikKICAgICAgICBpZiBoZWFkIHRoZW4KICAgICAgICAgICAgaGVhZC5UcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIGxvY2FsIHZhcl9nZHJoNHggPSBoZWFkOkZpbmRGaXJzdENoaWxkKCJmYWNlIikKICAgICAgICAgICAgaWYgZmFjZSB0aGVuCiAgICAgICAgICAgICAgICBmYWNlLlRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKbG9jYWwgdmFyX2o0ZHBuZCByZW1vdmVIZWFkbGVzcygpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdmFyX3N0aGIzMCA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBub3QgY2hhciB0aGVuIHJldHVybiBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfbDRmcmlyID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiSGVhZCIpCiAgICAgICAgaWYgaGVhZCB0aGVuCiAgICAgICAgICAgIGhlYWQuVHJhbnNwYXJlbmN5ID0gMAogICAgICAgICAgICBsb2NhbCB2YXJfZ2NuYzBvID0gaGVhZDpGaW5kRmlyc3RDaGlsZCgiZmFjZSIpCiAgICAgICAgICAgIGlmIGZhY2UgdGhlbgogICAgICAgICAgICAgICAgZmFjZS5UcmFuc3BhcmVuY3kgPSAwCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tIFdhbGtTcGVlZCBGdW5jdGlvbnMgKE9wdGltaXplZCkKbG9jYWwgdmFyX2lqdXM3Nwpsb2NhbCB2YXJfZnd1OWpiID0gMApsb2NhbCB2YXJfNXh1aW95IGFwcGx5V2Fsa1NwZWVkKCkKICAgIGlmIHdhbGtTcGVlZENvbm5lY3Rpb24gdGhlbgogICAgICAgIHdhbGtTcGVlZENvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICBlbmQKICAgIAogICAgaWYgV2Fsa1NwZWVkRW5hYmxlZCB0aGVuCiAgICAgICAgd2Fsa1NwZWVkQ29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCB2YXJfY245MW5jID0gdGljaygpCiAgICAgICAgICAgIGlmIGN1cnJlbnRUaW1lIC0gbGFzdFdhbGtTcGVlZFVwZGF0ZSA8IDAuNSB0aGVuIHJldHVybiBlbmQKICAgICAgICAgICAgbGFzdFdhbGtTcGVlZFVwZGF0ZSA9IGN1cnJlbnRUaW1lCiAgICAgICAgICAgIAogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfM3Z5a3MxID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9hMWF1MHUgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWQuV2Fsa1NwZWVkID0gV2Fsa1NwZWVkVmFsdWUKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kKQogICAgZWxzZQogICAgICAgIGlmIHdhbGtTcGVlZENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICB3YWxrU3BlZWRDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICB3YWxrU3BlZWRDb25uZWN0aW9uID0gbmlsCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCB2YXJfcnYxbm0yID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICBpZiBjaGFyIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9mb2hrcGsgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICAgICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgaHVtYW5vaWQuV2Fsa1NwZWVkID0gb3JpZ2luYWxXYWxrU3BlZWQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKZW5kCgotLSBNb2JpbGUtY29tcGF0aWJsZSBpbnB1dCBoYW5kbGluZwpsb2NhbCB2YXJfeGQ3YmF5IHBlcmZvcm1DbGljaygpCiAgICBsb2NhbCB2YXJfdmFiOHplID0gQ2FtZXJhLlZpZXdwb3J0U2l6ZQogICAgbG9jYWwgdmFyX3pxMmE4ayA9IHNpemUuWCAvIDIgKyB4Q2xpY2tPZmZzZXQKICAgIGxvY2FsIHZhcl9mejVzNHEgPSBzaXplLlkgLyAyCiAgICBWaXJ0dWFsSW5wdXRNYW5hZ2VyOlNlbmRNb3VzZUJ1dHRvbkV2ZW50KGNsaWNrWCwgY2xpY2tZLCAwLCB0cnVlLCBnYW1lLCAxKQogICAgdGFzay53YWl0KCkKICAgIFZpcnR1YWxJbnB1dE1hbmFnZXI6U2VuZE1vdXNlQnV0dG9uRXZlbnQoY2xpY2tYLCBjbGlja1ksIDAsIGZhbHNlLCBnYW1lLCAxKQplbmQKCi0tIEZha2UgU2hvdCBGdW5jdGlvbgpsb2NhbCB2YXJfMnRzbjNzIHBlcmZvcm1GYWtlU2hvdCgpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgaWYgbm90IElzSG9sZGluZ0Jhc2tldGJhbGwoKSB0aGVuIHJldHVybiBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfbGpsMXY5ID0gQ2FtZXJhLkNGcmFtZQogICAgICAgIENhbWVyYS5DRnJhbWUgPSBDRnJhbWUubmV3KENoYXJhY3Rlci5IZWFkLlBvc2l0aW9uLCBDaGFyYWN0ZXIuSGVhZC5Qb3NpdGlvbiArIFZlY3RvcjMubmV3KDAsIDEwMCwgMCkpCiAgICAgICAgdGFzay53YWl0KDAuMDEpCiAgICAgICAgcGVyZm9ybUNsaWNrKCkKICAgICAgICB0YXNrLndhaXQoMC4wMSkKICAgICAgICBDYW1lcmEuQ0ZyYW1lID0gb2xkQ0ZyYW1lCiAgICBlbmQpCmVuZAoKLS0gT3B0aW1pemVkIFdhbGsgRmxpbmcKbG9jYWwgdmFyX3RyOWRhZgpsb2NhbCB2YXJfdXN0eGR0IHN0YXJ0V2Fsa0ZsaW5nKCkKICAgIGlmIHdhbGtGbGluZ0Nvbm5lY3Rpb24gdGhlbgogICAgICAgIHdhbGtGbGluZ0Nvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICBlbmQKICAgIAogICAgd2Fsa0ZsaW5nQ29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIFdhbGtGbGluZ0VuYWJsZWQgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBsb2NhbCB2YXJfdTdmMWU5ID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgaWYgbm90IGNoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxvY2FsIHZhcl81ZHFvcGkgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgICAgICAgICAgICAgIGlmIHJvb3RQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICByb290UGFydC5WZWxvY2l0eSA9IHJvb3RQYXJ0LkNGcmFtZS5Mb29rVmVjdG9yICogV2Fsa0ZsaW5nUG93ZXIKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKLS0gUGVyZm9ybWFuY2UgRnVuY3Rpb25zCmxvY2FsIHZhcl9qc2d4OHggYXBwbHlGUFNCb29zdGVyKCkKICAgIGlmIEZQU0Jvb3N0ZXJFbmFibGVkIHRoZW4KICAgICAgICBmb3IgXywgdiBpbiBwYWlycyhMaWdodGluZzpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiB2OklzQSgiQmxvb21FZmZlY3QiKSBvciB2OklzQSgiQmx1ckVmZmVjdCIpIG9yIHY6SXNBKCJDb2xvckNvcnJlY3Rpb25FZmZlY3QiKSBvciB2OklzQSgiU3VuUmF5c0VmZmVjdCIpIHRoZW4KICAgICAgICAgICAgICAgIHYuRW5hYmxlZCA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIHNldHRpbmdzKCkuUmVuZGVyaW5nLlF1YWxpdHlMZXZlbCA9IEVudW0uUXVhbGl0eUxldmVsLkxldmVsMDEKICAgIGVsc2UKICAgICAgICBzZXR0aW5ncygpLlJlbmRlcmluZy5RdWFsaXR5TGV2ZWwgPSBFbnVtLlF1YWxpdHlMZXZlbC5BdXRvbWF0aWMKICAgIGVuZAplbmQKCmxvY2FsIHZhcl82d2xva3cgYXBwbHlBbnRpTGFnKCkKICAgIGlmIEFudGlMYWdFbmFibGVkIHRoZW4KICAgICAgICB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJUZXJyYWluIikuV2F0ZXJXYXZlU2l6ZSA9IDAKICAgICAgICB3b3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJUZXJyYWluIikuV2F0ZXJXYXZlU3BlZWQgPSAwCiAgICAgICAgd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVGVycmFpbiIpLldhdGVyUmVmbGVjdGFuY2UgPSAwCiAgICAgICAgd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiVGVycmFpbiIpLldhdGVyVHJhbnNwYXJlbmN5ID0gMAogICAgICAgIAogICAgICAgIGZvciBfLCB2IGluIHBhaXJzKHdvcmtzcGFjZTpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICBpZiB2OklzQSgiUGFydGljbGVFbWl0dGVyIikgb3IgdjpJc0EoIlRyYWlsIikgb3IgdjpJc0EoIlNtb2tlIikgb3IgdjpJc0EoIkZpcmUiKSBvciB2OklzQSgiU3BhcmtsZXMiKSB0aGVuCiAgICAgICAgICAgICAgICB2LkVuYWJsZWQgPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tIEFudGkgVHJhdmVsIEZ1bmN0aW9ucwpsb2NhbCB2YXJfb3ZwcnhsIHJlbmFtZVRvWigpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdmFyX2NkeHNrdiA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBjaGFyIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyXzJtY3p3bSA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoIkJhc2tldGJhbGwiKQogICAgICAgICAgICBpZiBiIHRoZW4KICAgICAgICAgICAgICAgIGIuTmFtZSA9ICJ6IgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgpsb2NhbCB2YXJfbmtqdTU3IHJlbmFtZVRvQmFza2V0YmFsbCgpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgdmFyX2pwZnplZCA9IFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBjaGFyIHRoZW4KICAgICAgICAgICAgbG9jYWwgdmFyX2ViNXFobyA9IGNoYXI6RmluZEZpcnN0Q2hpbGQoInoiKQogICAgICAgICAgICBpZiB6IHRoZW4KICAgICAgICAgICAgICAgIHouTmFtZSA9ICJCYXNrZXRiYWxsIgogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgpsb2NhbCB2YXJfbXNteG13IG1vbml0b3JBbnRpVHJhdmVsU3RhdGVzKCkKICAgIGlmIGFudGlUcmF2ZWxDb25uZWN0aW9uIHRoZW4KICAgICAgICBhbnRpVHJhdmVsQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgICAgICBhbnRpVHJhdmVsQ29ubmVjdGlvbiA9IG5pbAogICAgZW5kCgogICAgbG9jYWwgdmFyX2I4ZTRzeSA9IFBsYXllci5DaGFyYWN0ZXIKICAgIGlmIG5vdCBjaGFyIHRoZW4gcmV0dXJuIGVuZAoKICAgIGxvY2FsIHZhcl9uYXNwd3UgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICBpZiBub3QgaHVtYW5vaWQgdGhlbiByZXR1cm4gZW5kCgogICAgYW50aVRyYXZlbENvbm5lY3Rpb24gPSBodW1hbm9pZC5TdGF0ZUNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihfLCBuZXcpCiAgICAgICAgaWYgbm90IEFudGlUcmF2ZWxFbmFibGVkIHRoZW4gcmV0dXJuIGVuZAoKICAgICAgICBpZiBuZXcgPT0gRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5GcmVlZmFsbCBvciBuZXcgPT0gRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5KdW1waW5nIHRoZW4KICAgICAgICAgICAgaW5BaXIgPSB0cnVlCiAgICAgICAgICAgIHJlbmFtZVRvWigpCiAgICAgICAgZWxzZWlmIG5ldyA9PSBFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkxhbmRlZCBvciBuZXcgPT0gRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5SdW5uaW5nIHRoZW4KICAgICAgICAgICAgaW5BaXIgPSBmYWxzZQogICAgICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgICAgICBpZiBub3QgaW5BaXIgYW5kIEFudGlUcmF2ZWxFbmFibGVkIHRoZW4KICAgICAgICAgICAgICAgIHJlbmFtZVRvQmFza2V0YmFsbCgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tIE9wdGltaXplZCBBdXRvIER1bmsKbG9jYWwgdmFyXzdwdG1zdCB0b2dnbGVBdXRvRHVuaygpCiAgICBpZiBBdXRvRHVua0VuYWJsZWQgdGhlbgogICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICB3aGlsZSBBdXRvRHVua0VuYWJsZWQgZG8KICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfMDkwY3ZqID0gUGxheWVyLkNoYXJhY3RlcgogICAgICAgICAgICAgICAgICAgIGlmIGNoYXIgYW5kIGNoYXI6RmluZEZpcnN0Q2hpbGQoIkJhc2tldGJhbGwiKSBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJDb3VydHMiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgXywgY291cnQgaW4gcGFpcnMod29ya3NwYWNlLkNvdXJ0czpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9scGd1dnkgPSBjb3VydDpGaW5kRmlyc3RDaGlsZCgiRHVua1BhcnQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR1bmtQYXJ0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX29naHJnZiA9IChjaGFyLkh1bWFub2lkUm9vdFBhcnQuUG9zaXRpb24gLSBkdW5rUGFydC5Qb3NpdGlvbikuTWFnbml0dWRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRpc3RhbmNlIDwgNTAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhci5IdW1hbm9pZFJvb3RQYXJ0LkNGcmFtZSA9IGR1bmtQYXJ0LkNGcmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay53YWl0KDAuMykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKZW5kCgotLSBBdXRvIEd1YXJkIEZ1bmN0aW9ucyAoTW9iaWxlIENvbXBhdGlibGUpCmxvY2FsIHZhcl8yNzdxeDAgY3JlYXRlQXV0b0d1YXJkVUkoKQogICAgaWYgYXV0b0d1YXJkVUkgYW5kIGF1dG9HdWFyZFVJLlBhcmVudCB0aGVuCiAgICAgICAgYXV0b0d1YXJkVUk6RGVzdHJveSgpCiAgICBlbmQKCiAgICBhdXRvR3VhcmRVSSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKICAgIGF1dG9HdWFyZFVJLk5hbWUgPSAiQXV0b0d1YXJkVUkiCiAgICBhdXRvR3VhcmRVSS5QYXJlbnQgPSBQbGF5ZXI6V2FpdEZvckNoaWxkKCJQbGF5ZXJHdWkiKQoKICAgIGxvY2FsIHZhcl92bHRwMTQgPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQogICAgQnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMCwgODAsIDAsIDgwKQogICAgQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAuODUsIDAsIDAuNywgMCkKICAgIEJ1dHRvbi5BbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMC41KQogICAgQnV0dG9uLlRleHQgPSAiRW5hYmxlIEF1dG9HdWFyZCIKICAgIEJ1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIEJ1dHRvbi5Gb250ID0gRW51bS5Gb250LkZyZWRva2FPbmUKICAgIEJ1dHRvbi5UZXh0U2l6ZSA9IDE0CiAgICBCdXR0b24uVGV4dFNjYWxlZCA9IHRydWUKICAgIEJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAsIDIwLCAzMCkKICAgIEJ1dHRvbi5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgICBCdXR0b24uQXV0b0J1dHRvbkNvbG9yID0gZmFsc2UKICAgIEJ1dHRvbi5TZWxlY3RhYmxlID0gZmFsc2UKICAgIEJ1dHRvbi5QYXJlbnQgPSBhdXRvR3VhcmRVSQoKICAgIGxvY2FsIHZhcl8zOGRsb20gPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQogICAgVUlHcmFkaWVudC5Db2xvciA9IENvbG9yU2VxdWVuY2UubmV3KHsKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDAsIDEwMCwgMjU1KSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLCBDb2xvcjMuZnJvbVJHQigxMDAsIDAsIDI1NSkpCiAgICB9KQogICAgVUlHcmFkaWVudC5Sb3RhdGlvbiA9IDQ1CiAgICBVSUdyYWRpZW50LlBhcmVudCA9IEJ1dHRvbgoKICAgIGxvY2FsIHZhcl9zeG9iOHUgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKICAgIFVJQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAuMywgMCkKICAgIFVJQ29ybmVyLlBhcmVudCA9IEJ1dHRvbgoKICAgIGxvY2FsIHZhcl9wd2p0bnggPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikKICAgIFVJU3Ryb2tlLlRoaWNrbmVzcyA9IDMKICAgIFVJU3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMCwgMjAwLCAyNTUpCiAgICBVSVN0cm9rZS5BcHBseVN0cm9rZU1vZGUgPSBFbnVtLkFwcGx5U3Ryb2tlTW9kZS5Cb3JkZXIKICAgIFVJU3Ryb2tlLlBhcmVudCA9IEJ1dHRvbgoKICAgIGxvY2FsIHZhcl9tNWs0bHcgdXBkYXRlSW5wdXQoaW5wdXQpCiAgICAgICAgbG9jYWwgdmFyX2tycjY0byA9IGlucHV0LlBvc2l0aW9uIC0gZHJhZ1N0YXJ0CiAgICAgICAgQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KHN0YXJ0UG9zLlguU2NhbGUsIHN0YXJ0UG9zLlguT2Zmc2V0ICsgZGVsdGEuWCwgc3RhcnRQb3MuWS5TY2FsZSwgc3RhcnRQb3MuWS5PZmZzZXQgKyBkZWx0YS5ZKQogICAgZW5kCgogICAgQnV0dG9uLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgb3IgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuVG91Y2ggdGhlbgogICAgICAgICAgICBkcmFnZ2luZyA9IHRydWUKICAgICAgICAgICAgZHJhZ1N0YXJ0ID0gaW5wdXQuUG9zaXRpb24KICAgICAgICAgICAgc3RhcnRQb3MgPSBCdXR0b24uUG9zaXRpb24KICAgICAgICAgICAgCiAgICAgICAgICAgIGlucHV0LkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRTdGF0ZSA9PSBFbnVtLlVzZXJJbnB1dFN0YXRlLkVuZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZHJhZ2dpbmcgPSBmYWxzZQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICBCdXR0b24uSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuTW91c2VNb3ZlbWVudCBvciBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIGRyYWdJbnB1dCA9IGlucHV0CiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgVXNlcklucHV0U2VydmljZS5JbnB1dENoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBpbnB1dCA9PSBkcmFnSW5wdXQgYW5kIGRyYWdnaW5nIHRoZW4KICAgICAgICAgICAgdXBkYXRlSW5wdXQoaW5wdXQpCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgbG9jYWwgdmFyXzdoc2F0YyBnZXRDaGFyYWN0ZXIocCkgcmV0dXJuIHAgYW5kIHAuQ2hhcmFjdGVyIGVuZAogICAgbG9jYWwgdmFyX3VzOGZieSBnZXRCYWxsKHApIGxvY2FsIHZhcl9sbTY2bmcgPSBnZXRDaGFyYWN0ZXIocCkgcmV0dXJuIGMgYW5kIGM6RmluZEZpcnN0Q2hpbGQoIkJhc2tldGJhbGwiKSBlbmQKICAgIGxvY2FsIHZhcl9ndzd2Z2IgaGFzQmFsbEZ1bmMocCkgcmV0dXJuIChnZXRCYWxsKHApIH49IG5pbCkgZW5kCiAgICBsb2NhbCB2YXJfbGVvY3cwIGdldFJvb3RQYXJ0KHApIGxvY2FsIHZhcl9ydnh6a3UgPSBnZXRDaGFyYWN0ZXIocCkgcmV0dXJuIGMgYW5kIGM6RmluZEZpcnN0Q2hpbGQoIkh1bWFub2lkUm9vdFBhcnQiKSBlbmQKICAgIGxvY2FsIHZhcl9rd3FuZXggZ2V0Um9vdFBvc2l0aW9uKHApIGxvY2FsIHZhcl9wZDhrbnAgPSBnZXRSb290UGFydChwKSByZXR1cm4gcnAgYW5kIHJwLlBvc2l0aW9uIGVuZAogICAgbG9jYWwgdmFyX3YxdHlpbyBnZXRIdW1hbm9pZChwKSBsb2NhbCB2YXJfdWZiYXZxID0gZ2V0Q2hhcmFjdGVyKHApIHJldHVybiBjIGFuZCBjOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpIGVuZAoKICAgIGxvY2FsIHZhcl8zczBrcDQgd2Fsa1RvKHRhcmdldCkKICAgICAgICBsb2NhbCB2YXJfNXQ5djRhID0gZ2V0SHVtYW5vaWQoUGxheWVyKQogICAgICAgIGlmIG5vdCBodW0gdGhlbiByZXR1cm4gZW5kCiAgICAgICAgaWYgbm90IHRhcmdldCB0aGVuCiAgICAgICAgICAgIGh1bTpNb3ZlKFZlY3RvcjMuemVybywgZmFsc2UpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIGh1bTpNb3ZlVG8odGFyZ2V0KQogICAgZW5kCgogICAgbG9jYWwgdmFyX2NhNDh3aCBnZXROZWFyZXN0QmFsbEhhbmRsZXIoKQogICAgICAgIGxvY2FsIHZhcl8wbzB1OHcgPSBtYXRoLmh1Z2UKICAgICAgICBsb2NhbCB2YXJfcWt3YzIyID0gbmlsCiAgICAgICAgbG9jYWwgdmFyX3VndG02MSA9IGdldFJvb3RQb3NpdGlvbihQbGF5ZXIpCiAgICAgICAgaWYgbm90IG15Um9vdFBvcyB0aGVuIHJldHVybiBuaWwsIGRpc3QgZW5kCgogICAgICAgIGZvciBfLCBjYW5kaWRhdGUgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgICAgICBpZiBjYW5kaWRhdGUgfj0gUGxheWVyIGFuZCBoYXNCYWxsRnVuYyhjYW5kaWRhdGUpIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHZhcl8xa2h5bm0gPSBnZXRSb290UG9zaXRpb24oY2FuZGlkYXRlKQogICAgICAgICAgICAgICAgaWYgY2FuZGlkYXRlUm9vdFBvcyB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX2lhdGx3eSA9IChteVJvb3RQb3MgLSBjYW5kaWRhdGVSb290UG9zKS5NYWduaXR1ZGUKICAgICAgICAgICAgICAgICAgICBpZiBtYWcgPCBkaXN0IHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgZGlzdCA9IG1hZwogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRQbGF5ZXIgPSBjYW5kaWRhdGUKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgaWYgZGlzdCA8PSA4MCB0aGVuCiAgICAgICAgICAgIHJldHVybiB0YXJnZXRQbGF5ZXIsIGRpc3QKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBuaWwsIGRpc3QKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGxvY2FsIHZhcl92aWNod2ogYXV0b0d1YXJkTG9vcCgpCiAgICAgICAgd2hpbGUgYXV0b0d1YXJkU3RhdGUuZW5hYmxlZCBkbwogICAgICAgICAgICBpZiBoYXNCYWxsRnVuYyhQbGF5ZXIpIHRoZW4KICAgICAgICAgICAgICAgIHdhbGtUbyhuaWwpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGxvY2FsIHZhcl85Zmp4eWEsIGRpc3RhbmNlID0gZ2V0TmVhcmVzdEJhbGxIYW5kbGVyKCkKICAgICAgICAgICAgICAgIGlmIHRhcmdldCB0aGVuCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX3hwZzI4cyA9IGdldFJvb3RQb3NpdGlvbih0YXJnZXQpCiAgICAgICAgICAgICAgICAgICAgbG9jYWwgdmFyX2Z5ZWs3aCA9IGdldEh1bWFub2lkKHRhcmdldCkKICAgICAgICAgICAgICAgICAgICBpZiB0YXJnZXRQb3MgYW5kIHRhcmdldEh1bSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHZhcl9vZ3JjeHEgPSB0YXJnZXRIdW0uTW92ZURpcmVjdGlvbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfaDl5NjhpID0gdGFyZ2V0UG9zICsgKGRpciAqIFByZWRpY3Rpb25NdWx0aXBsaWVyKQogICAgICAgICAgICAgICAgICAgICAgICB3YWxrVG8ocHJlZGljdGVkUG9zKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHdhbGtUbyhuaWwpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHRhc2sud2FpdChVUERBVEVfSU5URVJWQUwpCiAgICAgICAgZW5kCiAgICAgICAgd2Fsa1RvKG5pbCkKICAgIGVuZAoKICAgIEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBhdXRvR3VhcmRTdGF0ZS5lbmFibGVkID0gbm90IGF1dG9HdWFyZFN0YXRlLmVuYWJsZWQKICAgICAgICBCdXR0b24uVGV4dCA9IGF1dG9HdWFyZFN0YXRlLmVuYWJsZWQgYW5kICJEaXNhYmxlIEF1dG9HdWFyZCIgb3IgIkVuYWJsZSBBdXRvR3VhcmQiCiAgICAgICAgCiAgICAgICAgaWYgYXV0b0d1YXJkU3RhdGUuZW5hYmxlZCB0aGVuCiAgICAgICAgICAgIFVJR3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICAgICAgICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDI1NSwgMTAwLCAwKSksCiAgICAgICAgICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDI1NSwgMCwgMTAwKSkKICAgICAgICAgICAgfSkKICAgICAgICAgICAgVUlTdHJva2UuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDEwMCwgMCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIFVJR3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICAgICAgICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAsIENvbG9yMy5mcm9tUkdCKDAsIDEwMCwgMjU1KSksCiAgICAgICAgICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDEwMCwgMCwgMjU1KSkKICAgICAgICAgICAgfSkKICAgICAgICAgICAgVUlTdHJva2UuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAyMDAsIDI1NSkKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBpZiBhdXRvR3VhcmRTdGF0ZS5lbmFibGVkIGFuZCBub3QgYXV0b0d1YXJkU3RhdGUucnVubmluZyB0aGVuCiAgICAgICAgICAgIGF1dG9HdWFyZFN0YXRlLnJ1bm5pbmcgPSB0cnVlCiAgICAgICAgICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgYXV0b0d1YXJkTG9vcCgpCiAgICAgICAgICAgICAgICBhdXRvR3VhcmRTdGF0ZS5ydW5uaW5nID0gZmFsc2UKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIHJldHVybiBhdXRvR3VhcmRVSQplbmQKCmxvY2FsIHZhcl9kdjFiZjYgc2V0QXV0b0d1YXJkKGVuYWJsZWQpCiAgICBpZiBlbmFibGVkIHRoZW4KICAgICAgICBjcmVhdGVBdXRvR3VhcmRVSSgpCiAgICBlbHNlCiAgICAgICAgaWYgYXV0b0d1YXJkVUkgdGhlbgogICAgICAgICAgICBhdXRvR3VhcmRVSTpEZXN0cm95KCkKICAgICAgICAgICAgYXV0b0d1YXJkVUkgPSBuaWwKICAgICAgICBlbmQKICAgICAgICBhdXRvR3VhcmRTdGF0ZS5lbmFibGVkID0gZmFsc2UKICAgICAgICBhdXRvR3VhcmRTdGF0ZS5ydW5uaW5nID0gZmFsc2UKICAgIGVuZAplbmQKCi0tIEFyYyBGdW5jdGlvbnMKbG9jYWwgdmFyX2c0YzUyOSBMb3dBcmMoZGlzdGFuY2UpCiAgICBpZiBkaXN0YW5jZSA+PSA1OCBhbmQgZGlzdGFuY2UgPCA1OSB0aGVuIHJldHVybiAyMyBlbmQKICAgIGlmIGRpc3RhbmNlID49IDU5IGFuZCBkaXN0YW5jZSA8IDYwIHRoZW4gcmV0dXJuIDI3IGVuZAogICAgaWYgZGlzdGFuY2UgPj0gNjAgYW5kIGRpc3RhbmNlIDwgNjEgdGhlbiByZXR1cm4gMzUgZW5kCiAgICBpZiBkaXN0YW5jZSA+PSA2MSBhbmQgZGlzdGFuY2UgPCA2MiB0aGVuIHJldHVybiAzNyBlbmQKICAgIGlmIGRpc3RhbmNlID49IDYyIGFuZCBkaXN0YW5jZSA8IDYzIHRoZW4gcmV0dXJuIDIyIGVuZAogICAgaWYgZGlzdGFuY2UgPj0gNjMgYW5kIGRpc3RhbmNlIDwgNjQgdGhlbiByZXR1cm4gMjYgZW5kCiAgICBpZiBkaXN0YW5jZSA+PSA2NCBhbmQgZGlzdGFuY2UgPCA2NSB0aGVuIHJldHVybiAyOCBlbmQKICAgIGlmIGRpc3RhbmNlID49IDY1IGFuZCBkaXN0YW5jZSA8IDY2IHRoZW4gcmV0dXJuIDMyIGVuZAogICAgaWYgZGlzdGFuY2UgPj0gNjYgYW5kIGRpc3RhbmNlIDwgNjcgdGhlbiByZXR1cm4gMzUgZW5kCiAgICBpZiBkaXN0YW5jZSA+PSA2NyBhbmQgZGlzdGFuY2UgPCA2Ny42IHRoZW4gcmV0dXJuIDI0IGVuZAogICAgaWYgZGlzdGFuY2UgPj0gNjcuNiBhbmQgZGlzdGFuY2UgPCA2OCB0aGVuIHJldHVybiAyNSBlbmQKICAgIGlmIGRpc3RhbmNlID49IDY4IGFuZCBkaXN0YW5jZSA8IDY4LjYgdGhlbiByZXR1cm4gMjYgZW5kCiAgICBpZiBkaXN0YW5jZSA+PSA2OC42IGFuZCBkaXN0YW5jZSA8IDY5IHRoZW4gcmV0dXJuIDI3IGVuZAogICAgaWYgZGlzdGFuY2UgPj0gNjkgYW5kIGRpc3RhbmNlIDwgNzAgdGhlbiByZXR1cm4gMzAgZW5kCiAgICBpZiBkaXN0YW5jZSA+PSA3MCBhbmQgZGlzdGFuY2UgPCA3MC42IHRoZW4gcmV0dXJuIDMxIGVuZAogICAgaWYgZGlzdGFuY2UgPj0gNzAuNiBhbmQgZGlzdGFuY2UgPCA3MSB0aGVuIHJldHVybiAzMiBlbmQKICAgIGlmIGRpc3RhbmNlID49IDcxIGFuZCBkaXN0YW5jZSA8IDcyIHRoZW4gcmV0dXJuIDM1IGVuZAogICAgaWYgZGlzdGFuY2UgPj0gNzIgYW5kIGRpc3RhbmNlIDwgNzIuNiB0aGVuIHJldHVybiAzOCBlbmQKICAgIGlmIGRpc3RhbmNlID49IDcyLjYgYW5kIGRpc3RhbmNlIDw9IDczIHRoZW4gcmV0dXJuIDM5IGVuZAogICAgaWYgZGlzdGFuY2UgPCA1OCB0aGVuIHJldHVybiAyMCBlbmQKICAgIGlmIGRpc3RhbmNlID4gNzMgdGhlbiByZXR1cm4gNDUgZW5kCmVuZAoKbG9jYWwgdmFyX2h2M3FxdiBIaWdoQXJjKGRpc3QpCiAgICByZXR1cm4gKHsKICAgICAgICBbMTVdID0gMTYwLCBbMTZdID0gMTU3LCBbMTddID0gMTU1LCBbMThdID0gMTUyLCBbMTldID0gMTQ5LCBbMjBdID0gMTQ3LAogICAgICAgIFsyMV0gPSAxNDQsIFsyMl0gPSAxNDEsIFsyM10gPSAxMzksIFsyNF0gPSAxMzcsIFsyNV0gPSAxMzUsIFsyNl0gPSAxMzIsCiAgICAgICAgWzI3XSA9IDEzMCwgWzI4XSA9IDEyNywgWzI5XSA9IDEyNCwgWzMwXSA9IDEyMSwgWzMxXSA9IDExOSwgWzMyXSA9IDExNywKICAgICAgICBbMzNdID0gMTE1LCBbMzRdID0gMTEyLCBbMzVdID0gMTA5LCBbMzZdID0gMTA5LCBbMzddID0gMTA4LCBbMzhdID0gMTA4LAogICAgICAgIFszOV0gPSAxMDgsIFs0MF0gPSAxMDgsIFs0MV0gPSAxMDcsIFs0Ml0gPSAxMDYsIFs0M10gPSAxMDUsIFs0NF0gPSAxMDQsCiAgICAgICAgWzQ1XSA9IDEwMywgWzQ2XSA9IDEwMiwgWzQ3XSA9IDEwMSwgWzQ4XSA9IDEwMywgWzQ5XSA9IDEwMywgWzUwXSA9IDEwMiwKICAgICAgICBbNTFdID0gMTAyLCBbNTJdID0gMTAwLCBbNTNdID0gMTAwLCBbNTRdID0gMTAxLCBbNTVdID0gOTgsIFs1Nl0gPSA5NiwKICAgICAgICBbNTddID0gOTQsIFs1OF0gPSA5NCwgWzU5XSA9IDg5LCBbNjBdID0gODksIFs2MV0gPSA4OSwgWzYyXSA9IDg5LAogICAgICAgIFs2M10gPSA4NSwgWzY0XSA9IDgzLCBbNjVdID0gODMsIFs2Nl0gPSA3OCwgWzY3XSA9IDc4LCBbNjhdID0gNzIsCiAgICAgICAgWzY5XSA9IDcyLCBbNzBdID0gNjYsIFs3MV0gPSA2MywgWzcyXSA9IDYyCiAgICB9KVtkaXN0XSBvciAwCmVuZAoKbG9jYWwgdmFyX2ZmamxzayBJc0hvbGRpbmdCYXNrZXRiYWxsKCkKICAgIGxvY2FsIHZhcl9zdzZyYmggPSBDaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoIkJhc2tldGJhbGwiKQogICAgcmV0dXJuIEJhbGwgYW5kIEJhbGw6RmluZEZpcnN0Q2hpbGQoIkJhbGwiKQplbmQKCmxvY2FsIHZhcl9qa3ZuNDYgR2V0R29hbCgpCiAgICBsb2NhbCB2YXJfYmE3Y2M1ID0gbWF0aC5odWdlCiAgICBsb2NhbCB2YXJfcDBtbGxjCiAgICBsb2NhbCB2YXJfbmRrMGVtID0gQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGlmIG5vdCBocnAgdGhlbiByZXR1cm4gbmlsLCBEaXN0YW5jZSBlbmQKICAgIGxvY2FsIHZhcl9vc2U2dnAgPSBocnAuUG9zaXRpb24KICAgIAogICAgZm9yIF8sIGNvbnRhaW5lciBpbiBwYWlycyh7d29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJDb3VydHMiKSwgd29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJQcmFjdGljZUFyZWEiKX0pIGRvCiAgICAgICAgaWYgY29udGFpbmVyIHRoZW4KICAgICAgICAgICAgZm9yIF8sIGNvdXJ0IGluIHBhaXJzKGNvbnRhaW5lcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgZm9yIF8sIG9iaiBpbiBwYWlycyhjb3VydDpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgICAgICAgICAgICAgIGlmIG9iai5OYW1lID09ICJTd2lzaCIgYW5kIG9iai5QYXJlbnQ6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJUb3VjaFRyYW5zbWl0dGVyIikgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCB2YXJfcjBvaXg3ID0gKGhycC5Qb3NpdGlvbiAtIG9iai5QYXJlbnQuUG9zaXRpb24pLk1hZ25pdHVkZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBtYWcgPCBEaXN0YW5jZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEaXN0YW5jZSA9IG1hZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgR29hbCA9IG9iai5QYXJlbnQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBHb2FsLCBEaXN0YW5jZQplbmQKCmxvY2FsIHZhcl92ODhwZmwgQWRqdXN0UG93ZXIoZGlzdGFuY2UpCiAgICBQbGF5ZXI6U2V0QXR0cmlidXRlKCJQb3dlciIsIDg1KQplbmQKCmxvY2FsIHZhcl9veG93czQgVmVsb2NpdHkoKQogICAgbG9jYWwgdmFyX2U2b2d4YyA9IENoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICByZXR1cm4gaHJwIGFuZCBocnAuVmVsb2NpdHkgb3IgVmVjdG9yMy56ZXJvCmVuZAoKLS0gRml4ZWQgU2lsZW50IEFpbSAtIExlc3MgQWNjdXJhdGUgKE5vIEF1dG8gR3JlZW5zKQpsb2NhbCB2YXJfOWpqZnN2IEFkanVzdENhbWVyYUZvckp1bXAoKQogICAgaWYgbm90IEFpbWJvdEVuYWJsZWQgb3Igbm90IElzSG9sZGluZ0Jhc2tldGJhbGwoKSB0aGVuIHJldHVybiBlbmQKICAgIAogICAgbG9jYWwgdmFyX3lqZzN2ZSwgRGlzdGFuY2UgPSBHZXRHb2FsKCkKICAgIGlmIG5vdCBHb2FsIG9yIERpc3RhbmNlID4gNzMgb3IgRGlzdGFuY2UgPCAxNSB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCB2YXJfczV0MjhiID0gQ2FtZXJhLkNGcmFtZQogICAgCiAgICBsb2NhbCB2YXJfbGNieGtzID0gVmVsb2NpdHkoKQogICAgbG9jYWwgdmFyXzhlczFleiA9IGN1cnJlbnRWZWxvY2l0eSAqIDAuMDgKICAgIAogICAgbG9jYWwgdmFyXzNmcWZveiA9IEFyY1R5cGUgPT0gIkhpZ2ggQXJjIiBhbmQgSGlnaEFyYyhtYXRoLmZsb29yKERpc3RhbmNlKSkgb3IgTG93QXJjKERpc3RhbmNlKQogICAgCiAgICBsb2NhbCB2YXJfNTI2Z20xID0gR29hbC5Qb3NpdGlvbiArIFZlY3RvcjMubmV3KDAsIGFyY1ZhbHVlLCAwKSArIHZlbG9jaXR5QWRqdXN0bWVudAoKICAgIEFkanVzdFBvd2VyKERpc3RhbmNlKQogICAgCiAgICBDYW1lcmEuQ0ZyYW1lID0gQ0ZyYW1lLm5ldyhDaGFyYWN0ZXIuSGVhZC5Qb3NpdGlvbiwgQmFza2V0UG9zaXRpb24pCiAgICB0YXNrLndhaXQoMC4wMTUpCiAgICBwZXJmb3JtQ2xpY2soKQogICAgdGFzay53YWl0KDAuMDE1KQogICAgQ2FtZXJhLkNGcmFtZSA9IG9sZENGcmFtZQplbmQKCi0tIE1vYmlsZS1jb21wYXRpYmxlIGlucHV0IGRldGVjdGlvbgpVc2VySW5wdXRTZXJ2aWNlLkp1bXBSZXF1ZXN0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgaWYgbm90IEFpbWJvdEVuYWJsZWQgdGhlbiByZXR1cm4gZW5kCiAgICB0YXNrLndhaXQoU2hvdERlbGF5KQogICAgQWRqdXN0Q2FtZXJhRm9ySnVtcCgpCmVuZCkKCi0tIE1vYmlsZSAmIFBDIGNvbXBhdGlibGUgRmFrZSBTaG90ClVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0LCBnYW1lUHJvY2Vzc2VkKQogICAgaWYgZ2FtZVByb2Nlc3NlZCB0aGVuIHJldHVybiBlbmQKICAgIAogICAgaWYgaW5wdXQuS2V5Q29kZSA9PSBFbnVtLktleUNvZGUuRiBhbmQgRmFrZVNob3RFbmFibGVkIHRoZW4KICAgICAgICBwZXJmb3JtRmFrZVNob3QoKQogICAgZW5kCmVuZCkKClBsYXllci5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKGNoYXIpCiAgICBDaGFyYWN0ZXIgPSBjaGFyCiAgICB0YXNrLndhaXQoMSkKCiAgICBsb2NhbCB2YXJfZWVreDhxID0gY2hhcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgaWYgaHVtYW5vaWQgdGhlbgogICAgICAgIG9yaWdpbmFsV2Fsa1NwZWVkID0gaHVtYW5vaWQuV2Fsa1NwZWVkCiAgICBlbmQKCiAgICBpZiBBbnRpVHJhdmVsRW5hYmxlZCB0aGVuCiAgICAgICAgbW9uaXRvckFudGlUcmF2ZWxTdGF0ZXMoKQogICAgZW5kCiAgICAKICAgIGlmIEtvcmJsb3hFbmFibGVkIHRoZW4KICAgICAgICBhcHBseUtvcmJsb3goKQogICAgZW5kCiAgICAKICAgIGlmIFNob3dOb0xlZ0VuYWJsZWQgdGhlbgogICAgICAgIGFwcGx5U2hvd05vTGVnKCkKICAgIGVuZAogICAgCiAgICBpZiBIZWFkbGVzc0VuYWJsZWQgdGhlbgogICAgICAgIGFwcGx5SGVhZGxlc3MoKQogICAgZW5kCiAgICAKICAgIGlmIFdhbGtTcGVlZEVuYWJsZWQgdGhlbgogICAgICAgIGFwcGx5V2Fsa1NwZWVkKCkKICAgIGVuZAplbmQpCgotLSBJbml0aWFsaXplIFdhbGsgRmxpbmcKc3RhcnRXYWxrRmxpbmcoKQoKLS0gTG9hZGluZyBTY3JlZW4gRnVuY3Rpb24KbG9jYWwgdmFyX2x2dXhvMCBjcmVhdGVMb2FkaW5nU2NyZWVuKCkKICAgIGxvY2FsIHZhcl84cnduZmkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCiAgICBMb2FkaW5nR3VpLk5hbWUgPSAiQ3lyb0xvYWRpbmdTY3JlZW4iCiAgICBMb2FkaW5nR3VpLlBhcmVudCA9IFBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpCiAgICBMb2FkaW5nR3VpLlJlc2V0T25TcGF3biA9IGZhbHNlCiAgICBMb2FkaW5nR3VpLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5TaWJsaW5nCiAgICAKICAgIGxvY2FsIHZhcl9kb2FjYXIgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgIEJhY2tncm91bmQuTmFtZSA9ICJCYWNrZ3JvdW5kIgogICAgQmFja2dyb3VuZC5TaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApCiAgICBCYWNrZ3JvdW5kLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDApCiAgICBCYWNrZ3JvdW5kLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxNSwgMTUsIDIwKQogICAgQmFja2dyb3VuZC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC44NQogICAgQmFja2dyb3VuZC5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgICBCYWNrZ3JvdW5kLlBhcmVudCA9IExvYWRpbmdHdWkKICAgIAogICAgbG9jYWwgdmFyX2J3M3dsYyA9IEluc3RhbmNlLm5ldygiQmx1ckVmZmVjdCIpCiAgICBCbHVyRWZmZWN0LlNpemUgPSAyNAogICAgQmx1ckVmZmVjdC5QYXJlbnQgPSBMaWdodGluZwogICAgCiAgICBsb2NhbCB2YXJfYmh6N21wID0gSW5zdGFuY2UubmV3KCJVSUdyYWRpZW50IikKICAgIFVJR3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigxMCwgMTAsIDE1KSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjUsIENvbG9yMy5mcm9tUkdCKDIwLCAyNSwgMzUpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEsIENvbG9yMy5mcm9tUkdCKDEwLCAxMCwgMTUpKQogICAgfSkKICAgIFVJR3JhZGllbnQuUm90YXRpb24gPSA0NQogICAgVUlHcmFkaWVudC5UcmFuc3BhcmVuY3kgPSBOdW1iZXJTZXF1ZW5jZS5uZXcoMC44NSkKICAgIFVJR3JhZGllbnQuUGFyZW50ID0gQmFja2dyb3VuZAogICAgCiAgICBsb2NhbCB2YXJfc3oweWh5ID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgVGV4dExhYmVsLk5hbWUgPSAiQ3lyb1RleHQiCiAgICBUZXh0TGFiZWwuU2l6ZSA9IFVEaW0yLm5ldygwLCA2MDAsIDAsIDEwMCkKICAgIFRleHRMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNDUsIDApCiAgICBUZXh0TGFiZWwuQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSkKICAgIFRleHRMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgVGV4dExhYmVsLlRleHQgPSAiIgogICAgVGV4dExhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDIwMCwgMjU1KQogICAgVGV4dExhYmVsLkZvbnQgPSBFbnVtLkZvbnQuRnJlZG9rYU9uZQogICAgVGV4dExhYmVsLlRleHRTaXplID0gODAKICAgIFRleHRMYWJlbC5UZXh0VHJhbnNwYXJlbmN5ID0gMAogICAgVGV4dExhYmVsLlBhcmVudCA9IEJhY2tncm91bmQKICAgIAogICAgbG9jYWwgdmFyXzd4NW0xeCA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiKQogICAgVGV4dFN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDAsIDE1MCwgMjU1KQogICAgVGV4dFN0cm9rZS5UaGlja25lc3MgPSAzCiAgICBUZXh0U3Ryb2tlLlBhcmVudCA9IFRleHRMYWJlbAogICAgCiAgICBsb2NhbCB2YXJfbXhiZWd6ID0gSW5zdGFuY2UubmV3KCJJbWFnZUxhYmVsIikKICAgIExvZ29JbWFnZS5OYW1lID0gIkxvZ28iCiAgICBMb2dvSW1hZ2UuU2l6ZSA9IFVEaW0yLm5ldygwLCAyMDAsIDAsIDIwMCkKICAgIExvZ29JbWFnZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuMzUsIDApCiAgICBMb2dvSW1hZ2UuQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSkKICAgIExvZ29JbWFnZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgTG9nb0ltYWdlLkltYWdlID0gImh0dHA6Ly93d3cucm9ibG94LmNvbS9hc3NldC8/aWQ9MTE3ODI5NTQ2NTg2NDQ5IgogICAgTG9nb0ltYWdlLkltYWdlVHJhbnNwYXJlbmN5ID0gMQogICAgTG9nb0ltYWdlLlNjYWxlVHlwZSA9IEVudW0uU2NhbGVUeXBlLkZpdAogICAgTG9nb0ltYWdlLlBhcmVudCA9IEJhY2tncm91bmQKICAgIAogICAgbG9jYWwgdmFyXzZzb2d3MSA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQogICAgTG9nb0Nvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLjIsIDApCiAgICBMb2dvQ29ybmVyLlBhcmVudCA9IExvZ29JbWFnZQogICAgCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICB0YXNrLndhaXQoMC4zKQogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl8xcGVid3IgPSAiQ1lSTyBIVUIiCiAgICAgICAgZm9yIGkgPSAxLCAjY3lyb1RleHQgZG8KICAgICAgICAgICAgVGV4dExhYmVsLlRleHQgPSBzdHJpbmcuc3ViKGN5cm9UZXh0LCAxLCBpKQogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgdmFyX2FmZDI3MyA9IFR3ZWVuU2VydmljZTpDcmVhdGUoVGV4dExhYmVsLCBUd2VlbkluZm8ubmV3KDAuMTUsIEVudW0uRWFzaW5nU3R5bGUuQmFjaywgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwgewogICAgICAgICAgICAgICAgVGV4dFNpemUgPSA5MAogICAgICAgICAgICB9KQogICAgICAgICAgICBsb2NhbCB2YXJfM3RwMjQ5ID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShUZXh0TGFiZWwsIFR3ZWVuSW5mby5uZXcoMC4xLCBFbnVtLkVhc2luZ1N0eWxlLlF1YWQsIEVudW0uRWFzaW5nRGlyZWN0aW9uLkluT3V0KSwgewogICAgICAgICAgICAgICAgVGV4dFNpemUgPSA4MAogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgc2NhbGVVcDpQbGF5KCkKICAgICAgICAgICAgc2NhbGVVcC5Db21wbGV0ZWQ6V2FpdCgpCiAgICAgICAgICAgIHNjYWxlRG93bjpQbGF5KCkKICAgICAgICAgICAgc2NhbGVEb3duLkNvbXBsZXRlZDpXYWl0KCkKICAgICAgICAgICAgCiAgICAgICAgICAgIHRhc2sud2FpdCgwLjIpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgdGFzay53YWl0KDAuNSkKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfNHVkNXR4ID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShUZXh0TGFiZWwsIFR3ZWVuSW5mby5uZXcoMC41LCBFbnVtLkVhc2luZ1N0eWxlLlF1YWQsIEVudW0uRWFzaW5nRGlyZWN0aW9uLkluT3V0KSwgewogICAgICAgICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNjUsIDApLAogICAgICAgICAgICBUZXh0U2l6ZSA9IDUwCiAgICAgICAgfSkKICAgICAgICB0ZXh0RmFkZTpQbGF5KCkKICAgICAgICB0ZXh0RmFkZS5Db21wbGV0ZWQ6V2FpdCgpCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyX3VhcDZsciA9IFR3ZWVuU2VydmljZTpDcmVhdGUoTG9nb0ltYWdlLCBUd2VlbkluZm8ubmV3KDAuOCwgRW51bS5FYXNpbmdTdHlsZS5RdWFkLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLCB7CiAgICAgICAgICAgIEltYWdlVHJhbnNwYXJlbmN5ID0gMAogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyX2MxaTZ0diA9IFR3ZWVuU2VydmljZTpDcmVhdGUoTG9nb0ltYWdlLCBUd2VlbkluZm8ubmV3KDAuOCwgRW51bS5FYXNpbmdTdHlsZS5CYWNrLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLCB7CiAgICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMjAwLCAwLCAyMDApCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBMb2dvSW1hZ2UuU2l6ZSA9IFVEaW0yLm5ldygwLCA1MCwgMCwgNTApCiAgICAgICAgbG9nb0ZhZGVJbjpQbGF5KCkKICAgICAgICBsb2dvU2NhbGU6UGxheSgpCiAgICAgICAgCiAgICAgICAgdGFzay53YWl0KDEuNSkKICAgICAgICAKICAgICAgICBsb2NhbCB2YXJfNm56cTdhID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShCYWNrZ3JvdW5kLCBUd2VlbkluZm8ubmV3KDAuOCwgRW51bS5FYXNpbmdTdHlsZS5RdWFkLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5Jbk91dCksIHsKICAgICAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICB9KQogICAgICAgIAogICAgICAgIGxvY2FsIHZhcl80NmZkMzQgPSBUd2VlblNlcnZpY2U6Q3JlYXRlKExvZ29JbWFnZSwgVHdlZW5JbmZvLm5ldygwLjgsIEVudW0uRWFzaW5nU3R5bGUuUXVhZCwgRW51bS5FYXNpbmdEaXJlY3Rpb24uSW5PdXQpLCB7CiAgICAgICAgICAgIEltYWdlVHJhbnNwYXJlbmN5ID0gMQogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyX3h3YzlrdiA9IFR3ZWVuU2VydmljZTpDcmVhdGUoVGV4dExhYmVsLCBUd2VlbkluZm8ubmV3KDAuOCwgRW51bS5FYXNpbmdTdHlsZS5RdWFkLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5Jbk91dCksIHsKICAgICAgICAgICAgVGV4dFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICB9KQogICAgICAgIAogICAgICAgIGZhZGVPdXQ6UGxheSgpCiAgICAgICAgbG9nb0ZhZGVPdXQ6UGxheSgpCiAgICAgICAgdGV4dEZhZGVPdXQ6UGxheSgpCiAgICAgICAgCiAgICAgICAgbG9jYWwgdmFyX2l2NnJpZiA9IFR3ZWVuU2VydmljZTpDcmVhdGUoQmx1ckVmZmVjdCwgVHdlZW5JbmZvLm5ldygwLjgsIEVudW0uRWFzaW5nU3R5bGUuUXVhZCwgRW51bS5FYXNpbmdEaXJlY3Rpb24uSW5PdXQpLCB7CiAgICAgICAgICAgIFNpemUgPSAwCiAgICAgICAgfSkKICAgICAgICBibHVyRmFkZU91dDpQbGF5KCkKICAgICAgICAKICAgICAgICBmYWRlT3V0LkNvbXBsZXRlZDpXYWl0KCkKICAgICAgICAKICAgICAgICBCbHVyRWZmZWN0OkRlc3Ryb3koKQogICAgICAgIExvYWRpbmdHdWk6RGVzdHJveSgpCiAgICBlbmQpCiAgICAKICAgIHJldHVybiBMb2FkaW5nR3VpCmVuZAoKY3JlYXRlTG9hZGluZ1NjcmVlbigpCgp0YXNrLndhaXQoNC41KQoKLS0gTm90aGluZyBVSSBMaWJyYXJ5CmxvY2FsIHZhcl9oZHBrZWEgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1NueGRmZXIvTm90aGluZy1VSS1MaWJyYXJ5L3JlZnMvaGVhZHMvbWFpbi9zb3VyY2UubHVhJykpKCkKCmxvY2FsIHZhcl9kb2JxNzkgPSBOb3RoaW5nTGlicmFyeS5uZXcoewogICAgVGl0bGUgPSAiQ3lybyBIdWIiLAogICAgRGVzY3JpcHRpb24gPSAiT3B0aW1pemVkICYgTW9iaWxlIENvbXBhdGlibGUiLAogICAgS2V5YmluZCA9IEVudW0uS2V5Q29kZS5MZWZ0Q29udHJvbCwKICAgIExvZ28gPSAnaHR0cDovL3d3dy5yb2Jsb3guY29tL2Fzc2V0Lz9pZD0xMTc4Mjk1NDY1ODY0NDknCn0pCgotLSBNQUlOIFRBQiAoUHJldmlvdXNseSBBaW1ib3QgVGFiKQpsb2NhbCB2YXJfMXpoY2twID0gV2luZG93czpOZXdUYWIoe1RpdGxlID0gIk1haW4iLCBEZXNjcmlwdGlvbiA9ICJNYWluIEZlYXR1cmVzIiwgSWNvbiA9ICJyYnhhc3NldGlkOi8vNzczMzk2MDk4MSJ9KQpsb2NhbCB2YXJfdXdtenE5ID0gTWFpblRhYjpOZXdTZWN0aW9uKHtUaXRsZSA9ICJBaW1ib3QgU2V0dGluZ3MiLCBJY29uID0gInJieGFzc2V0aWQ6Ly83NzQzODY5MDU0IiwgUG9zaXRpb24gPSAiTGVmdCJ9KQpsb2NhbCB2YXJfaWRiMGhwID0gTWFpblRhYjpOZXdTZWN0aW9uKHtUaXRsZSA9ICJDaGFyYWN0ZXIiLCBJY29uID0gInJieGFzc2V0aWQ6Ly83NzMzOTY0NzE5IiwgUG9zaXRpb24gPSAiUmlnaHQifSkKCi0tIEVYIFRBQgpsb2NhbCB2YXJfaHZxZnNvID0gV2luZG93czpOZXdUYWIoe1RpdGxlID0gIkVYIiwgRGVzY3JpcHRpb24gPSAiRXh0ZW5kZWQgRmVhdHVyZXMiLCBJY29uID0gInJieGFzc2V0aWQ6Ly83NzMzOTY0NzE5In0pCmxvY2FsIHZhcl9tZWw1ZGQgPSBFWFRhYjpOZXdTZWN0aW9uKHtUaXRsZSA9ICJNb3ZlbWVudCIsIEljb24gPSAicmJ4YXNzZXRpZDovLzc3NDM4NjkwNTQiLCBQb3NpdGlvbiA9ICJMZWZ0In0pCmxvY2FsIHZhcl80eDVyZnUgPSBFWFRhYjpOZXdTZWN0aW9uKHtUaXRsZSA9ICJCYWxsIE1hZ25ldCIsIEljb24gPSAicmJ4YXNzZXRpZDovLzc3MzM5NjQ3MTkiLCBQb3NpdGlvbiA9ICJSaWdodCJ9KQoKLS0gU09DSUFMIFRBQgpsb2NhbCB2YXJfN2xoOXlwID0gV2luZG93czpOZXdUYWIoe1RpdGxlID0gIlNvY2lhbCIsIERlc2NyaXB0aW9uID0gIlNvY2lhbCBGZWF0dXJlcyIsIEljb24gPSAicmJ4YXNzZXRpZDovLzc3MzM5NjQ3MTkifSkKbG9jYWwgdmFyXzIzM2VpZyA9IFNvY2lhbFRhYjpOZXdTZWN0aW9uKHtUaXRsZSA9ICJVdGlsaXR5IEZlYXR1cmVzIiwgSWNvbiA9ICJyYnhhc3NldGlkOi8vNzczMzk2NDcxOSIsIFBvc2l0aW9uID0gIkxlZnQifSkKbG9jYWwgdmFyX2E4dGJ2YyA9IFNvY2lhbFRhYjpOZXdTZWN0aW9uKHtUaXRsZSA9ICJEZXZpY2UgU3Bvb2ZlciIsIEljb24gPSAicmJ4YXNzZXRpZDovLzc3NDM4NjkwNTQiLCBQb3NpdGlvbiA9ICJSaWdodCJ9KQoKLS0gRVhUUkFTIFRBQgpsb2NhbCB2YXJfN21ocmo0ID0gV2luZG93czpOZXdUYWIoe1RpdGxlID0gIkV4dHJhcyIsIERlc2NyaXB0aW9uID0gIkV4dHJhIEZlYXR1cmVzIiwgSWNvbiA9ICJyYnhhc3NldGlkOi8vNzczMzk2NDcxOSJ9KQpsb2NhbCB2YXJfdmczY25yID0gRXh0cmFzVGFiOk5ld1NlY3Rpb24oe1RpdGxlID0gIlV0aWxpdHkiLCBJY29uID0gInJieGFzc2V0aWQ6Ly83NzQzODY5MDU0IiwgUG9zaXRpb24gPSAiTGVmdCJ9KQoKLS0gUEVSRk9STUFOQ0UgVEFCCmxvY2FsIHZhcl9vNXA0anogPSBXaW5kb3dzOk5ld1RhYih7VGl0bGUgPSAiUGVyZm9ybWFuY2UiLCBEZXNjcmlwdGlvbiA9ICJQZXJmb3JtYW5jZSBTZXR0aW5ncyIsIEljb24gPSAicmJ4YXNzZXRpZDovLzc3MzM5NjQ3MTkifSkKbG9jYWwgdmFyX2x5YjZsMiA9IFBlcmZvcm1hbmNlVGFiOk5ld1NlY3Rpb24oe1RpdGxlID0gIk9wdGltaXphdGlvbiIsIEljb24gPSAicmJ4YXNzZXRpZDovLzc3NDM4NjkwNTQiLCBQb3NpdGlvbiA9ICJMZWZ0In0pCgotLSA9PT09PT09PT09IE1BSU4gVEFCID09PT09PT09PT0KLS0gQWltYm90IFNldHRpbmdzCkFpbWJvdFNlY3Rpb246TmV3VG9nZ2xlKHsKICAgIFRpdGxlID0gIkVuYWJsZSBBaW1ib3QiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihFbmFibGVkKQogICAgICAgIEFpbWJvdEVuYWJsZWQgPSBFbmFibGVkCiAgICBlbmQKfSkKCkFpbWJvdFNlY3Rpb246TmV3RHJvcGRvd24oewogICAgVGl0bGUgPSAiQXJjIFR5cGUiLAogICAgRGF0YSA9IHsiTG93IEFyYyIsICJIaWdoIEFyYyJ9LAogICAgRGVmYXVsdCA9ICJMb3cgQXJjIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oU2VsZWN0ZWRBcmMpCiAgICAgICAgQXJjVHlwZSA9IFNlbGVjdGVkQXJjCiAgICBlbmQKfSkKCkFpbWJvdFNlY3Rpb246TmV3U2xpZGVyKHsKICAgIFRpdGxlID0gIlggT2Zmc2V0IiwKICAgIE1pbiA9IDAsCiAgICBNYXggPSAxMDAsCiAgICBEZWZhdWx0ID0gNDMsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIHhDbGlja09mZnNldCA9IFZhbHVlCiAgICBlbmQKfSkKCi0tIENoYXJhY3RlciBTZWN0aW9uIChNb3ZlZCBmcm9tIEVYKQpDaGFyYWN0ZXJTZWN0aW9uOk5ld1RvZ2dsZSh7CiAgICBUaXRsZSA9ICJLb3JibG94IiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oRW5hYmxlZCkKICAgICAgICBLb3JibG94RW5hYmxlZCA9IEVuYWJsZWQKICAgICAgICBpZiBFbmFibGVkIHRoZW4KICAgICAgICAgICAgYXBwbHlLb3JibG94KCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJlbW92ZUtvcmJsb3goKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpDaGFyYWN0ZXJTZWN0aW9uOk5ld1RvZ2dsZSh7CiAgICBUaXRsZSA9ICJTaG93IE5vIExlZyIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKEVuYWJsZWQpCiAgICAgICAgU2hvd05vTGVnRW5hYmxlZCA9IEVuYWJsZWQKICAgICAgICBpZiBFbmFibGVkIHRoZW4KICAgICAgICAgICAgYXBwbHlTaG93Tm9MZWcoKQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmVtb3ZlU2hvd05vTGVnKCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKQ2hhcmFjdGVyU2VjdGlvbjpOZXdUb2dnbGUoewogICAgVGl0bGUgPSAiSGVhZGxlc3MiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihFbmFibGVkKQogICAgICAgIEhlYWRsZXNzRW5hYmxlZCA9IEVuYWJsZWQKICAgICAgICBpZiBFbmFibGVkIHRoZW4KICAgICAgICAgICAgYXBwbHlIZWFkbGVzcygpCiAgICAgICAgZWxzZQogICAgICAgICAgICByZW1vdmVIZWFkbGVzcygpCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tID09PT09PT09PT0gRVggVEFCID09PT09PT09PT0KLS0gV2Fsa1NwZWVkCk1vdmVtZW50U2VjdGlvbjpOZXdUb2dnbGUoewogICAgVGl0bGUgPSAiV2Fsa1NwZWVkIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oRW5hYmxlZCkKICAgICAgICBXYWxrU3BlZWRFbmFibGVkID0gRW5hYmxlZAogICAgICAgIGFwcGx5V2Fsa1NwZWVkKCkKICAgIGVuZAp9KQoKTW92ZW1lbnRTZWN0aW9uOk5ld1NsaWRlcih7CiAgICBUaXRsZSA9ICJXYWxrU3BlZWQgVmFsdWUiLAogICAgTWluID0gMTYsCiAgICBNYXggPSAyMDAsCiAgICBEZWZhdWx0ID0gMTYsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIFdhbGtTcGVlZFZhbHVlID0gVmFsdWUKICAgIGVuZAp9KQoKLS0gQmFsbCBNYWduZXQgKE1vdmVkIGZyb20gTWFpbikKTWFnbmV0U2VjdGlvbjpOZXdUb2dnbGUoewogICAgVGl0bGUgPSAiRW5hYmxlIE1hZ3MiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihFbmFibGVkKQogICAgICAgIE1hZ3NFbmFibGVkID0gRW5hYmxlZAogICAgICAgIGlmIEVuYWJsZWQgdGhlbgogICAgICAgICAgICBhcHBseU1hZ3MoKQogICAgICAgIGVuZAogICAgZW5kCn0pCgpNYWduZXRTZWN0aW9uOk5ld1NsaWRlcih7CiAgICBUaXRsZSA9ICJNYWdzIEFtb3VudCIsCiAgICBNaW4gPSAxLAogICAgTWF4ID0gMjAwLAogICAgRGVmYXVsdCA9IDEwMCwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgTWFnc0Ftb3VudCA9IFZhbHVlCiAgICBlbmQKfSkKCi0tID09PT09PT09PT0gU09DSUFMIFRBQiA9PT09PT09PT09ClNvY2lhbFNlY3Rpb246TmV3VG9nZ2xlKHsKICAgIFRpdGxlID0gIkF1dG8gR3VhcmQiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihFbmFibGVkKQogICAgICAgIHNldEF1dG9HdWFyZChFbmFibGVkKQogICAgZW5kCn0pCgpTb2NpYWxTZWN0aW9uOk5ld1NsaWRlcih7CiAgICBUaXRsZSA9ICJHdWFyZCBQcmVkaWN0aW9uIiwKICAgIE1pbiA9IDEsCiAgICBNYXggPSAyMCwKICAgIERlZmF1bHQgPSA2LAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBQcmVkaWN0aW9uTXVsdGlwbGllciA9IFZhbHVlCiAgICBlbmQKfSkKClNvY2lhbFNlY3Rpb246TmV3VG9nZ2xlKHsKICAgIFRpdGxlID0gIkFudGkgVHJhdmVsIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oRW5hYmxlZCkKICAgICAgICBBbnRpVHJhdmVsRW5hYmxlZCA9IEVuYWJsZWQKICAgICAgICBpZiBFbmFibGVkIHRoZW4KICAgICAgICAgICAgbW9uaXRvckFudGlUcmF2ZWxTdGF0ZXMoKQogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgYW50aVRyYXZlbENvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICAgICAgYW50aVRyYXZlbENvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBhbnRpVHJhdmVsQ29ubmVjdGlvbiA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgcmVuYW1lVG9CYXNrZXRiYWxsKCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKU29jaWFsU2VjdGlvbjpOZXdUb2dnbGUoewogICAgVGl0bGUgPSAiQXV0byBEdW5rIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oRW5hYmxlZCkKICAgICAgICBBdXRvRHVua0VuYWJsZWQgPSBFbmFibGVkCiAgICAgICAgdG9nZ2xlQXV0b0R1bmsoKQogICAgZW5kCn0pCgotLSBEZXZpY2UgU3Bvb2ZlcgpEZXZpY2VTZWN0aW9uOk5ld1RvZ2dsZSh7CiAgICBUaXRsZSA9ICJFbmFibGUgRGV2aWNlIFNwb29mZXIiLAogICAgRGVmYXVsdCA9IGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihFbmFibGVkKQogICAgICAgIERldmljZVNwb29mZXJFbmFibGVkID0gRW5hYmxlZAogICAgICAgIGlmIERldmljZVNwb29mZXJFbmFibGVkIHRoZW4KICAgICAgICAgICAgRmlyZURldmljZUV2ZW50KCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKRGV2aWNlU2VjdGlvbjpOZXdEcm9wZG93bih7CiAgICBUaXRsZSA9ICJEZXZpY2UgVHlwZSIsCiAgICBEYXRhID0geyJQQyIsICJNb2JpbGUiLCAiQ29uc29sZSJ9LAogICAgRGVmYXVsdCA9ICJQQyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFNlbGVjdGVkRGV2aWNlKQogICAgICAgIERldmljZVR5cGUgPSBTZWxlY3RlZERldmljZQogICAgICAgIGlmIERldmljZVNwb29mZXJFbmFibGVkIHRoZW4KICAgICAgICAgICAgRmlyZURldmljZUV2ZW50KCkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gPT09PT09PT09PSBFWFRSQVMgVEFCID09PT09PT09PT0KRXh0cmFzU2VjdGlvbjpOZXdUb2dnbGUoewogICAgVGl0bGUgPSAiRmFrZSBTaG90IChQcmVzcyBGKSIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKEVuYWJsZWQpCiAgICAgICAgRmFrZVNob3RFbmFibGVkID0gRW5hYmxlZAogICAgZW5kCn0pCgpFeHRyYXNTZWN0aW9uOk5ld1RvZ2dsZSh7CiAgICBUaXRsZSA9ICJXYWxrIEZsaW5nIiwKICAgIERlZmF1bHQgPSBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oRW5hYmxlZCkKICAgICAgICBXYWxrRmxpbmdFbmFibGVkID0gRW5hYmxlZAogICAgZW5kCn0pCgpFeHRyYXNTZWN0aW9uOk5ld1NsaWRlcih7CiAgICBUaXRsZSA9ICJXYWxrIEZsaW5nIFBvd2VyIiwKICAgIE1pbiA9IDEsCiAgICBNYXggPSA1MDAsCiAgICBEZWZhdWx0ID0gMTAwLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBXYWxrRmxpbmdQb3dlciA9IFZhbHVlCiAgICBlbmQKfSkKCi0tID09PT09PT09PT0gUEVSRk9STUFOQ0UgVEFCID09PT09PT09PT0KUGVyZm9ybWFuY2VTZWN0aW9uOk5ld1RvZ2dsZSh7CiAgICBUaXRsZSA9ICJGUFMgQm9vc3RlciIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKEVuYWJsZWQpCiAgICAgICAgRlBTQm9vc3RlckVuYWJsZWQgPSBFbmFibGVkCiAgICAgICAgYXBwbHlGUFNCb29zdGVyKCkKICAgIGVuZAp9KQoKUGVyZm9ybWFuY2VTZWN0aW9uOk5ld1RvZ2dsZSh7CiAgICBUaXRsZSA9ICJBbnRpIExhZyIsCiAgICBEZWZhdWx0ID0gZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKEVuYWJsZWQpCiAgICAgICAgQW50aUxhZ0VuYWJsZWQgPSBFbmFibGVkCiAgICAgICAgYXBwbHlBbnRpTGFnKCkKICAgIGVuZAp9KQ=='))()
